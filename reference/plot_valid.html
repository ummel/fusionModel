<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot validation results — plot_valid • fusionModel</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot validation results — plot_valid"><meta name="description" content="Creates and optionally saves to disk representative plots of validation results returned by validate. Requires the suggested ggplot2 package. This function is (by default) called within validate. Can be useful on its own to save graphics to disk or generate plots for a subset of fusion variables."><meta property="og:description" content="Creates and optionally saves to disk representative plots of validation results returned by validate. Requires the suggested ggplot2 package. This function is (by default) called within validate. Can be useful on its own to save graphics to disk or generate plots for a subset of fusion variables."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fusionModel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot validation results</h1>

      <div class="d-none name"><code>plot_valid.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates and optionally saves to disk representative plots of validation results returned by <code><a href="validate.html">validate</a></code>. Requires the suggested <code><a href="https://ggplot2.tidyverse.org/reference/ggplot2-package.html" class="external-link">ggplot2</a></code> package. This function is (by default) called within <code><a href="validate.html">validate</a></code>. Can be useful on its own to save graphics to disk or generate plots for a subset of fusion variables.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_valid</span><span class="op">(</span><span class="va">valid</span>, y <span class="op">=</span> <span class="cn">NULL</span>, path <span class="op">=</span> <span class="cn">NULL</span>, cores <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-valid">valid<a class="anchor" aria-label="anchor" href="#arg-valid"></a></dt>
<dd><p>Object returned by <code><a href="validate.html">validate</a></code>.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Character. Fusion variables to use for validation graphics. Useful for plotting partial validation results. Default is to use all fusion variables present in <code>valid</code>.</p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>Character. Path to directory where .png graphics are to be saved. Directory is created if necessary. If NULL (default), no files are saved to disk.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>Integer. Number of cores used. Only applicable on Unix systems.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed to <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></code> to control .png graphics saved to disk.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with "plots", "smooth", and "data" slots. The "plots" slot contains the following <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></code> objects:</p><ul><li><p>est: Comparison of point estimates (median absolute percent error).</p></li>
<li><p>moe: Comparison of 90% margin of error (median ratio of simulated-to-observed MOE).</p></li>
<li><p>Additional named slots (one for each of the fusion variables) contain the plots described above with scatterplot results.</p></li>
</ul><p>"smooth" is a data frame with the plotting values used to produce the smoothed median plots.
"data" is a data frame with the complete validation results as returned by the original call to <code><a href="validate.html">validate</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Validation results are visualized to convey expected, typical (median) performance of the fusion variables. That is, how well do the simulated data match the observed data with respect to point estimates and confidence intervals for population subsets of various size?</p>
<p>Plausible error metrics are derived from the input validation data for plotting. For comparison of point estimates, the error metric is absolute percent error for continuous variables; in the categorical case it is absolute error scaled such that the maximum possible error is 1. Since these metrics are not strictly comparable, the all-variable plots denote categorical fusion variables with dotted lines.</p>
<p>For a given fusion variable, the error metric will exhibit variation (often quite skewed) even for subsets of comparable size, due to the fact that each subset looks at a unique partition of the data. In order to convey how expected, typical performance varies with subset size, the smoothed median error conditional on subset size is approximated and plotted.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Build a fusion model using RECS microdata</span></span>
<span><span class="co"># Note that "fusion_model.fsn" will be written to working directory</span></span>
<span><span class="va">fusion.vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"electricity"</span>, <span class="st">"natural_gas"</span>, <span class="st">"aircon"</span><span class="op">)</span></span>
<span><span class="va">predictor.vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">recs</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span></span>
<span><span class="va">fsn.path</span> <span class="op">&lt;-</span> <span class="fu"><a href="train.html">train</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">recs</span>,</span>
<span>                  y <span class="op">=</span> <span class="va">fusion.vars</span>,</span>
<span>                  x <span class="op">=</span> <span class="va">predictor.vars</span>,</span>
<span>                  weight <span class="op">=</span> <span class="st">"weight"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fuse back onto the donor data (multiple implicates)</span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="fuse.html">fuse</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">recs</span>,</span>
<span>            file <span class="op">=</span> <span class="va">fsn.path</span>,</span>
<span>            M <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate validation results but do not generate plots</span></span>
<span><span class="va">valid</span> <span class="op">&lt;-</span> <span class="fu"><a href="validate.html">validate</a></span><span class="op">(</span>observed <span class="op">=</span> <span class="va">recs</span>,</span>
<span>                  implicates <span class="op">=</span> <span class="va">sim</span>,</span>
<span>                  subset_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"income"</span>, <span class="st">"education"</span>, <span class="st">"race"</span>, <span class="st">"urban_rural"</span><span class="op">)</span>,</span>
<span>                  weight <span class="op">=</span> <span class="st">"weight"</span>,</span>
<span>                  plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create validation plots</span></span>
<span><span class="va">valid</span> <span class="op">&lt;-</span> <span class="fu">plot_valid</span><span class="op">(</span><span class="va">valid</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View some of the plots</span></span>
<span><span class="va">valid</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="va">est</span></span>
<span><span class="va">valid</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="va">moe</span></span>
<span><span class="va">valid</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="va">electricity</span><span class="op">$</span><span class="va">bias</span></span>
<span></span>
<span><span class="co"># Can also save the plots to disk at creation</span></span>
<span><span class="co"># Will save .png files to 'valid_plots' folder in working directory</span></span>
<span><span class="co"># Note that it is fine to pass a 'valid' object with existing $plots slot</span></span>
<span><span class="co"># In that case, the plots are simply re-generated</span></span>
<span><span class="va">vplots</span> <span class="op">&lt;-</span> <span class="fu">plot_valid</span><span class="op">(</span><span class="va">valid</span>,</span>
<span>                     path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"valid_plots"</span><span class="op">)</span>,</span>
<span>                     width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kevin Ummel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

